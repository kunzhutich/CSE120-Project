-- This is the query that pulls all F orders from TXDB and inserts into RHDB.Orders

INSERT IGNORE INTO RHDB.Orders 
  (`COMBO`, `LAT`, `SG`, `NAME`, `PHONE`, `FLOW`, `HOURS`, `ACRE`, `CROP`, `TYPE`, `DATE`, `TRANTIME`, `EX`, `FINAL`, `COMMENT`, `SBXCFS`, `DELETED`, `SA`)
SELECT 
  CONCAT(TRIM(EVENT.PARCEL), '  ', TRIM(EVENT.WATERID)) AS 'COMBO', 
  EVENT.LATERAL AS 'LAT', 
  EVENT.SIDEGATE AS 'SG', 
  EVENT.NAME1 AS 'NAME', 
  EVENT.PHONE1 AS 'PHONE', 
  EVENT.RQSTFLO AS 'FLOW', 
  EVENT.HOURS, 
  PARCD.PIACR AS 'ACRE', 
  EVENT.CROP1 AS 'CROP', 
  EVENT.IRRIGTYP AS 'TYPE', 
  EVENT.EVENT_TRANDATE AS 'DATE', 
  EVENT.TRANTIME, 
  EVENT.EXCESSIVEORDER AS 'EX', 
  PARCD.LASTIRRIGATION AS 'FINAL', 
  CONCAT(EVENT.COMMENT1,'    ',EVENT.COMMENT2) AS 'COMMENT', 
  SBXDTL.SBXCFS, 
  EVENT.DELETED, 
  EVENT.SERVAREA AS 'SA'  
FROM 
  TXDB.EVENT EVENT
  JOIN TXDB.PARCD PARCD ON EVENT.WTIDNO = PARCD.TIDPNUMB 
  JOIN TXDB.SBXDTL SBXDTL ON EVENT.FLOWID = SBXDTL.FLOWID 
WHERE 
  (
    (EVENT.IRRIGTYP='01' AND EVENT.ISPEC='WRQST' AND EVENT.SERVAREA='01' AND EVENT.EVENT_TRANDATE > '2023-06-01' AND EVENT.EVENT_TRANDATE < '2023-06-08' AND SBXDTL.SBXDFT='X') 
    OR 
    (EVENT.IRRIGTYP='01' AND EVENT.ISPEC='WRQST' AND EVENT.SERVAREA='03' AND EVENT.EVENT_TRANDATE > '2023-06-01' AND EVENT.EVENT_TRANDATE < '2023-06-08' AND SBXDTL.SBXDFT='X') 
    OR 
    (EVENT.IRRIGTYP='01' AND EVENT.ISPEC='wrqst' AND EVENT.SERVAREA='05' AND EVENT.EVENT_TRANDATE > '2023-06-01' AND EVENT.EVENT_TRANDATE < '2023-06-08' AND SBXDTL.SBXDFT='X')
  );